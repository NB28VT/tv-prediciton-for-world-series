<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<div class = "row">
  <div class = "large-12-columns", style= "display: block; margin:auto" >
    <%= image_tag("world-series-ninja.png")%>
  </div>
</div>

<div class = "row">
  <div class = "large-4-columns">

    <label>Pick Teams
    <%= form_tag("/home", method: "get") do %>
      <%= select("team1", "team_id",
        Team.where(league: League.where(name:"National")).collect {|p| [ p.name, p.id ] },
        {prompt: 'Select National League Team'},
        { class: 'chosen-select'}
      ) %>

      <%= select("team2", "team_id",
        Team.where(league: League.where(name:"American")).collect {|p| [ p.name, p.id ] },
        {prompt: 'Select American League Team'},
        { class: 'chosen-select'}
      ) %>

    <%= submit_tag("Submit") %>
    <% end %>

  </div>

  <% if @combined_odds %>
    <div class = "row">
      <div class = "large-4 columns">
        <%= image_tag(@team_1_logo) %>
      </div>

      <div class = "large-4 columns">
        <h2>The odds of this series happening are <%= "#{@combined_odds}" %>/1</h2>
      </div>

      <div class = "large-4 columns">
        <%= image_tag(@team_2_logo) %>
      </div>
    </div>
  <% end %>

<div class="row">
  <div id="container" class="large-6-columns" ></div>
  <div id="container" class = "large-6-columns"></div>
</div>



<script>
$(function () {
  $('#container').highcharts({
      chart: {
          type: 'bar'
      },
      title: {
          text: 'Predicted TV audience (in millions)'
      },
      subtitle: {
          text: 'Source: Wikipedia.org'
      },
      xAxis: {
          categories: ["Four Game Series", "Five Game Series", "Six Game Series", "Seven Game Sereies"],
          title: {
              text: null
          }
      },
      yAxis: {
          min: 0,
          title: {
              text: 'Population (millions)',
              align: 'high'
          },
          labels: {
              overflow: 'justify'
          }
      },
      tooltip: {
          valueSuffix: ' millions'
      },
      plotOptions: {
          bar: {
              dataLabels: {
                  enabled: true
              }
          }
      },
      legend: {
          layout: 'vertical',
          align: 'right',
          verticalAlign: 'top',
          x: -40,
          y: 100,
          floating: true,
          borderWidth: 1,
          backgroundColor: ((Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'),
          shadow: true
      },
      credits: {
          enabled: false
      },
      series: [{
          name: 'Viewers',
          data: [<%= @four_game_viewership %>,
            <%= @five_game_viewership %>,
            <%= @six_game_viewership %>,
            <%= @seven_game_viewership %>
            ]
      }]
  });
});


</script>
